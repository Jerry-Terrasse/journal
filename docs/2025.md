## Journal-2025

### 1.8

#### uv安装PyTorch最佳实践

1. 在系统中安装所需CUDA版本

2. 根据PyTorch和CUDA版本需求，在[PyTorch官网](https://pytorch.org/get-started/locally/)确定要使用的index

3. 在`pyproject.toml`中添加相应源，并指定`explicit = true`使得仅`torch`相关包使用该源。
   例如：

   ```toml
   [tool.uv.sources]
   torch = [{ index = "pytorch-cu121" }]
   torchvision = [{ index = "pytorch-cu121" }]
   
   [[tool.uv.index]]
   url = "https://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple"
   default = true
   
   [[tool.uv.index]]
   name = "pytorch-cu121"
   url = "https://download.pytorch.org/whl/cu121"
   explicit = true
   ```

4. 执行`uv sync`同步环境

[ref](https://docs.astral.sh/uv/guides/integration/pytorch/)

### 1.7

#### git打包文件

git可以将工作区打包为压缩包，只包含被跟踪的文件

```shell
git archive --output "./output.tar.gz" master # 文件类型通过--output自动推断
```

#### 对Gradio应用进行反向代理

反代gradio应用时（例如`example.com/gradio-demo -> localhost:7860`），由于gradio无法感知到外部url路径，会给出错误的资源url，可以通过设置`GRADIO_ROOT_PATH`环境变量解决。[ref](https://www.gradio.app/guides/running-gradio-on-your-web-server-with-nginx)

```nginx
server {
    listen 80;
    server_name example.com www.example.com;  # Change this to your domain name

    location /gradio-demo/ {  # Change this if you'd like to server your Gradio app on a different path
        proxy_pass http://127.0.0.1:7860/; # Change this if your Gradio app will be running on a different port
        proxy_buffering off;
        proxy_redirect off;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-Host $host;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

### 1.6

#### Shell在管道中间复制一份到错误流

```shell
command1 | command2 # original
command1 | tee /dev/stderr | command2 # for debug
```

### 1.1

$\text{The Best Year Ever!}$
